-- Global Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlayerName = LocalPlayer.Name

-- *** KONFIGURASI INTI ***
-- Multiplier yang sangat tinggi (10 Triliun)
local HYPER_MULTIPLIER = 10000000000000 
local TRAIN_TYPE = 1 -- Default ke Arms

-- Remote Event/Function (Ambil dari log Anda)
local ApplyStationaryTrain = ReplicatedStorage:FindFirstChild("TrainEquipment"):FindFirstChild("Remote"):FindFirstChild("ApplyStationaryTrain")
local TrainSpeedRemote = ReplicatedStorage:FindFirstChild("TrainSystem"):FindFirstChild("Remote"):FindFirstChild("TrainSpeedHasChanged")
local TryOperatingItemByPlayer = ReplicatedStorage:FindFirstChild("PlayerItemBackpack"):FindFirstChild("Remote"):FindFirstChild("TryOperatingItemByPlayer")

-- Fungsi untuk memastikan Remote ada
local function isRemoteValid(remote)
    if not remote then
        warn("Remote tidak ditemukan!")
        return false
    end
    return true
end

-- =========================================================================
--                                 FUNGSI UTAMA TRAIN HACK REVISI
-- =========================================================================

local function executeHyperTrain(trainType)
    if not isRemoteValid(TrainSpeedRemote) then
        print("Gagal: Remote TrainSpeedHasChanged tidak tersedia.")
        return
    end

    -- STRATEGI 1: MENGGANTI NILAI TRAIN SPEED DENGAN MULTIPLIER TINGGI
    -- Kita asumsikan bahwa nilai yang dikirim ke TrainSpeedHasChanged adalah *peningkatan* speed/multiplier.
    
    local originalValue = TrainSpeedRemote:InvokeServer() -- Coba dapatkan nilai original jika itu RemoteFunction
    local boostValue = originalValue or 4 -- Jika gagal, gunakan nilai default (4)

    -- Kirim nilai yang sangat tinggi sebagai speed.
    local finalSpeed = HYPER_MULTIPLIER 
    
    print(string.format("Mengirim Hyper Train Speed sebesar %s (Tipe: %d)...", tostring(finalSpeed), trainType))
    
    -- TRAIN SPEED HANYA MENERIMA 1 ARGUMEN (dilihat dari log: TrainSpeedHasChanged:FireServer(4))
    -- Kita harus memanggil *ApplyStationaryTrain* agar train benar-benar aktif di server.
    
    if ApplyStationaryTrain and ApplyStationaryTrain.ClassName == "RemoteFunction" then
        print("Memanggil ApplyStationaryTrain...")
        ApplyStationaryTrain:InvokeServer()
    end
    
    if TrainSpeedRemote and TrainSpeedRemote.ClassName == "UnreliableRemoteEvent" then
        -- Panggil TrainSpeedRemote setelah train dipicu
        TrainSpeedRemote:FireServer(finalSpeed)
        
        -- Panggil sekali lagi ApplyStationaryTrain untuk me-refresh
        if ApplyStationaryTrain and ApplyStationaryTrain.ClassName == "RemoteFunction" then
            ApplyStationaryTrain:InvokeServer()
        end
        
        print("Pengiriman Hyper Train Selesai. Periksa Combat Power!")
    else
        warn("Remote TrainSpeedRemote tidak valid atau bukan RemoteEvent/Function yang tepat.")
    end

end

-- =========================================================================
--                             FUNGSI BUFF HACK REVISI
-- =========================================================================

local function useBuffItem(itemId, gridIndex)
    if not isRemoteValid(TryOperatingItemByPlayer) then
        print("Gagal: Remote TryOperatingItemByPlayer tidak tersedia.")
        return
    end

    -- Manipulasi Item Num ke nilai yang sangat besar
    local HYPER_ITEM_COUNT = 999999999 

    local itemData = {
        GridInfo = {
            Id = itemId,
            Num = HYPER_ITEM_COUNT -- Injeksi nilai besar di sini
        },
        GridIndex = gridIndex
    }
    local operationData = {
        Operation = "UseItem",
        PointingOperation = "UseSingleBuffConsum"
    }
    
    print(string.format("Mengaktifkan Item %d (Grid: %s) dengan jumlah %s...", itemId, gridIndex, tostring(HYPER_ITEM_COUNT)))
    
    -- Memanggil remote dengan jumlah item yang dimanipulasi
    local success = TryOperatingItemByPlayer:InvokeServer(
        itemData,
        itemId,
        HYPER_ITEM_COUNT, 
        operationData
    )
    
    if success == nil then
        print(string.format("Item %d Buff Berhasil Diaktifkan (Potensi Durasi/Efek x%s)!", itemId, tostring(HYPER_ITEM_COUNT)))
    else
        print(string.format("Item %d Buff Gagal/Balasan Server: %s", itemId, tostring(success)))
    end
end

-- =========================================================================
--                                      GUI (Menggunakan Library Umum)
-- =========================================================================

-- Implementasi GUI sederhana (menggunakan loadstring yang umum di Delta)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/wally-rblx/Linoria/main/Library.lua"))()

local Window = Library:CreateWindow("Delta Combat Power V2")

-- Tab Train Multiplier
local TrainTab = Window:AddTab("Hyper Train")
local TrainSection = TrainTab:AddSection("Hyper Training (Trillions CP)")

TrainSection:AddSlider("Multiplier Value", {
    Min = 1e12, 
    Max = 1e18, 
    Default = HYPER_MULTIPLIER,
    Decimals = 0,
    Text = "Value: " .. tostring(HYPER_MULTIPLIER),
    Callback = function(value)
        HYPER_MULTIPLIER = value
    end
})

-- Kita tidak perlu memilih tipe train karena kita memanipulasi Train Speed/Multiplier Global
TrainSection:AddLabel("‚ö†Ô∏è Pilih alat train yang ingin ditingkatkan di game, lalu klik tombol di bawah ini.")

TrainSection:AddButton("üöÄ AKTIFKAN HYPER SPEED TRAIN", function()
    -- Asumsi TrainType 1 selalu berlaku untuk Train Speed, atau server mengambil TrainType aktif.
    executeHyperTrain(TRAIN_TYPE) 
end)

-- ---
-- Tab Buff Multiplier (Item Buff)
local BuffTab = Window:AddTab("Item Buff")
local BuffSection = BuffTab:AddSection("Instant Buff x999999999")

BuffSection:AddLabel("Masukkan Grid Index item Anda (mis: 401, 407).")

BuffSection:AddButton("üß™ Item18 (Arms Buff)", function()
    -- Cek Grid Index yang benar di Backpack Anda
    local grid = "401" -- Ganti jika perlu
    useBuffItem(18, grid)
end)

BuffSection:AddButton("üß™ Item20 (Legs Buff)", function()
    local grid = "407" -- Ganti jika perlu
    useBuffItem(20, grid)
end)

BuffSection:AddButton("üß™ Item19 (Back Buff)", function()
    local grid = "402" -- Ganti jika perlu
    useBuffItem(19, grid)
end)

BuffSection:AddButton("üß™ Item21 (Agility Buff)", function()
    local grid = "401" -- Ganti jika perlu
    useBuffItem(21, grid)
end)

-- ---
-- Tab Utilities (Minimize/Close)
local UtilityTab = Window:AddTab("Utilities")
local UtilitySection = UtilityTab:AddSection("GUI Controls")

UtilitySection:AddButton("‚èèÔ∏è Minimize GUI", function()
    Window:Minimize()
end)

UtilitySection:AddButton("‚ùå Close GUI", function()
    Library:Unload()
end)
